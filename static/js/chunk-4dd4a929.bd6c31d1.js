(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4dd4a929","chunk-2d0a3c8b"],{"043d":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"head-container"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0},model:{value:e.query,callback:function(t){e.query=t},expression:"query"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{clearable:"",required:"true",minlength:"6",maxlength:"20",autocomplete:"off"},model:{value:e.query.search_name,callback:function(t){e.$set(e.query,"search_name",t)},expression:"query.search_name"}})],1),a("el-form-item",{attrs:{label:"账号",prop:"account"}},[a("el-input",{attrs:{clearable:"",minlength:"6",maxlength:"20",autocomplete:"off"},model:{value:e.query.search_account,callback:function(t){e.$set(e.query,"search_account",t)},expression:"query.search_account"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.toQuery}},[e._v("查询")])],1)],1)],1)},r=[],s={props:{query:{type:Object,required:!0},options:{type:Array}},mounted:function(){},methods:{toQuery:function(){this.$parent.page=0,this.$parent.dialogFormVisible=!1,this.$parent.init()}}},i=s,n=a("2877"),l=Object(n["a"])(i,o,r,!1,null,null,null);t["default"]=l.exports},"1f34":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("search",{ref:"search",attrs:{options:e.selectOptions,query:e.query}}),a("el-col",{attrs:{span:24}},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-button-group",[a("el-button",{directives:[{name:"has",rawName:"v-has"}],attrs:{type:"success",icon:"el-icon-plus"},on:{click:function(t){return e.showAddDialog()}}},[e._v("添加")]),a("el-button",{directives:[{name:"has",rawName:"v-has"}],attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(t){return e.removeDialog()}}},[e._v("删除")]),a("el-button",{directives:[{name:"has",rawName:"v-has"}],attrs:{type:"warning",icon:"el-icon-share"},on:{click:function(t){return e.grantRole()}}},[e._v("角色授权")])],1)],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"},{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{border:"",data:e.datalist,"tooltip-effect":"dark",size:"small"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),a("el-table-column",{attrs:{prop:"name",label:"名称",width:"150px"}}),a("el-table-column",{attrs:{prop:"deptid",label:"所属部门",width:"150px"}}),a("el-table-column",{attrs:{prop:"account",label:"账号",width:"100px"}}),a("el-table-column",{attrs:{prop:"roleIds",label:"拥有角色"}}),a("el-table-column",{attrs:{prop:"mobile",label:"手机号",width:"100px","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"name",label:"创建人",width:"100px"}}),a("el-table-column",{attrs:{prop:"puserId",label:"警员",width:"100px"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button-group",[a("el-button",{directives:[{name:"has",rawName:"v-has",value:"修改",expression:"'修改'"}],attrs:{type:"info",size:"mini",icon:"el-icon-edit"},on:{click:function(a){return e.showEdit(t.row)}}}),a("el-popover",{ref:t.row.id,attrs:{placement:"top",width:"180"}},[a("p",[e._v("确定删除本条数据吗？")]),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){e.$refs[t.row.id].doClose()}}},[e._v("取消")]),a("el-button",{attrs:{loading:e.delLoading,type:"primary",size:"mini"},on:{click:function(a){return e.removeById(t.row.id)}}},[e._v("确定")])],1),a("el-button",{directives:[{name:"has",rawName:"v-has",value:"删除",expression:"'删除'"}],attrs:{slot:"reference",type:"danger",size:"mini",icon:"el-icon-delete"},slot:"reference"})],1)],1)]}}])})],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-pagination",{attrs:{currentPageNo:0,"page-sizes":[15,20,50,100],"page-size":e.pageSize,layout:"total, prev, pager, next,sizes",total:e.total},on:{"size-change":e.sizeChange,"current-change":e.pageChange}})],1)],1),a("eform",{ref:"form",attrs:{options:e.puserData}}),a("role-dialog",{ref:"roledia"})],1)},r=[],s=(a("4160"),a("a15b"),a("b0c0"),a("159b"),a("c24f")),i=a("dc00"),n=a("043d"),l=a("7c8c"),c=a("6a9b"),u={mixins:[i["a"]],components:{search:n["default"],eform:l["default"],roleDialog:c["default"]},data:function(){return{puserData:[],list:[],multipleSelection:[],sup_this:this,query:{search_name:"",search_account:""},selectOptions:[],delLoading:!1,showAdd:!1}},created:function(){var e=this;this.$nextTick((function(){e.init().then((function(t){200===t.status&&(e.puserData=t.data.puserId)}))}))},mounted:function(){},methods:{beforeInit:function(){this.url="api/system/users";var e="name desc";return this.params={page:this.page+1,sortType:e,pageSize:this.pageSize,search_name:this.query.search_name,search_account:this.query.search_account},!0},handleSelectionChange:function(e){this.multipleSelection=e},showAddDialog:function(){this.$refs.form.visible=!0,this.$refs.form.isAdd=!0},showEdit:function(e){this.$refs.form.visible=!0,this.$refs.form.isAdd=!1,this.$refs.form.dataForm={id:e.id,name:e.name,account:e.account,mobile:e.mobile,memo:e.memo,puserId:e.puserId}},removeById:function(e){var t=this;this.delLoading=!0,Object(s["b"])(e).then((function(a){t.$message({message:"删除成功",type:"success"}),t.delLoading=!1,t.$refs[e].doClose(),t.init()})).catch((function(e){t.delLoading=!1,console.log("error:"+e),console.log(e)}))},removeDialog:function(){var e=this;0!==this.multipleSelection.length?this.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=[];e.multipleSelection.forEach((function(e){t.push(e.id)})),Object(s["b"])(t.join(",")).then((function(t){e.$message({message:"删除成功",type:"success"}),e.init()})).catch((function(e){console.log("error:"+e),console.log(e)}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})})):this.$message.error("请选择要删除的记录")},grantRole:function(){if(0!==this.multipleSelection.length){this.$refs.roledia.rolevisible=!0;var e=[];this.multipleSelection.forEach((function(t){e.push(t.name)})),this.$refs.roledia.userIds=this.multipleSelection,this.$refs.roledia.usernames="待授权的用户:"+e.join(",")}else this.$message.error("请选择要授权的用户")}},computed:{}},m=u,d=(a("36ad"),a("2877")),p=Object(d["a"])(m,o,r,!1,null,null,null);t["default"]=p.exports},"36ad":function(e,t,a){"use strict";var o=a("6264"),r=a.n(o);r.a},6264:function(e,t,a){},"7c8c":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.isAdd?"新增用户":"修改用户",closeOnClickModal:!1,visible:e.visible,width:"600px","label-width":"80px"},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"form",attrs:{"status-icon":"",model:e.dataForm,rules:e.rules,size:"small","label-position":"right","label-width":"70px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{clearable:"",required:"true",minlength:"6",maxlength:"20",autocomplete:"off"},model:{value:e.dataForm.name,callback:function(t){e.$set(e.dataForm,"name",t)},expression:"dataForm.name"}})],1),a("el-form-item",{attrs:{label:"账号",prop:"account"}},[a("el-input",{attrs:{clearable:"",minlength:"6",maxlength:"20",autocomplete:"off"},model:{value:e.dataForm.account,callback:function(t){e.$set(e.dataForm,"account",t)},expression:"dataForm.account"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:this.isAdd,expression:"this.isAdd"}],attrs:{label:"密码",prop:"pwd",rules:{required:this.isAdd,message:"密码不能为空",trigger:"blur"}}},[a("el-input",{attrs:{clearable:"",type:"password",minlength:"3",maxlength:"20",autocomplete:"off"},model:{value:e.dataForm.pwd,callback:function(t){e.$set(e.dataForm,"pwd",t)},expression:"dataForm.pwd"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:this.isAdd,expression:"this.isAdd"}],attrs:{label:"确认密码",prop:"repeatPasswd"}},[a("el-input",{attrs:{clearable:"",type:"password",minlength:"3",maxlength:"20",autocomplete:"off"},model:{value:e.dataForm.repeatPasswd,callback:function(t){e.$set(e.dataForm,"repeatPasswd",t)},expression:"dataForm.repeatPasswd"}})],1),a("el-form-item",{attrs:{label:"手机号",prop:"mobile"}},[a("el-input",{attrs:{clearable:"",autocomplete:"off"},model:{value:e.dataForm.mobile,callback:function(t){e.$set(e.dataForm,"mobile",t)},expression:"dataForm.mobile"}})],1),a("el-form-item",{attrs:{label:"警员",prop:"puserId"}},[a("el-select",{attrs:{filterable:"",placeholder:"可搜索选择警员"},model:{value:e.dataForm.puserId,callback:function(t){e.$set(e.dataForm,"puserId",t)},expression:"dataForm.puserId"}},e._l(e.options,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.name}})})),1)],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea",clearable:"",rows:3,maxlength:"300",autocomplete:"off"},model:{value:e.dataForm.memo,callback:function(t){e.$set(e.dataForm,"memo",t)},expression:"dataForm.memo"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.doSubmit}},[e._v("确 定")]),a("el-button",{on:{click:function(t){return e.cancel()}}},[e._v("取 消")])],1)],1)},r=[],s=a("c24f"),i={data:function(){var e=this,t=function(t,a,o){""===a?o(new Error("请输入密码")):(""!==e.dataForm.repeatPasswd&&e.$refs.dataForm.validateField("repeatPasswd"),o())},a=function(t,a,o){""===a?o(new Error("请再次输入密码")):a!==e.dataForm.pwd?o(new Error("两次输入密码不一致!")):o()};return{options:[],loading:!1,visible:!1,isAdd:!1,dataForm:{name:"",account:"",pwd:"",repeatPasswd:"",mobile:"",memo:"",puserId:""},rules:{pass:[{validator:t,trigger:"blur"}],repeatPasswd:[{validator:a,trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],account:[{required:!0,message:"请输入账号",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"},{pattern:/^[A-Za-z]+$/,message:"只能输入英文字符",trigger:"blur"}]}}},methods:{cancel:function(){this.resetForm()},resetForm:function(){this.visible=!1,this.$refs["form"].resetFields(),this.dataForm={name:"",account:"",pwd:"",repeatPasswd:"",mobile:"",memo:"",puserId:""}},doSubmit:function(){var e=this;this.dataForm.pwd===this.dataForm.repeatPasswd?this.$refs["form"].validate((function(t){t&&(e.isAdd?Object(s["a"])(e.dataForm).then((function(t){"ok"===t.result?(e.resetForm(),e.$message({message:"添加成功",type:"success"})):e.$message({message:"添加失败",type:"error"}),e.loading=!1,e.$parent.page=0,e.$parent.dialogFormVisible=!1,e.$parent.init()})).catch((function(e){console.log("error:"+e),console.log(e)})):e.doEdit())})):this.$message.error("两次输入密码不一致")},doEdit:function(){var e=this;this.isAdd||Object(s["d"])(this.dataForm).then((function(t){e.resetForm(),e.$message({message:"修改成功",type:"success"}),e.loading=!1,e.$parent.dialogFormVisible=!1,e.$parent.init()})).catch((function(e){console.log("error:"+e),console.log(e)}))}},created:function(){var e=this;Object(s["e"])().then((function(t){if("ok"===t.result){var a=t.data.result;e.options=a}}))}},n=i,l=a("2877"),c=Object(l["a"])(n,o,r,!1,null,null,null);t["default"]=c.exports}}]);